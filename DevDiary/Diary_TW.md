# WinUI 3 + Windows 系統還原工具開發實戰與微軟平台反思

## 技術挑戰與細節

在開發 WinUI 3 桌面應用時，我們遭遇了多項痛點。首先，XAML 控件有很多新規則，例如**ContentDialog** 必須手動設置 XamlRoot 才能顯示[\[1\]](https://learn.microsoft.com/zh-tw/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.contentdialog?view=windows-app-sdk-1.6#:~:text=%E7%95%B6%E6%82%A8%E9%A1%AF%E7%A4%BA%20ContentDialog%20%E6%99%82%EF%BC%8C%E6%82%A8%E5%BF%85%E9%A0%88%E6%89%8B%E5%8B%95%E5%B0%87%E5%B0%8D%E8%A9%B1%E6%A1%86%E7%9A%84%20XamlRoot%20%E8%A8%AD%E5%AE%9A%E7%82%BA,XamlRoot%20%E5%B1%AC%E6%80%A7%E8%A8%AD%E5%AE%9A%E7%82%BA%E8%88%87%E5%B7%B2%E5%9C%A8%20XAML%20%E6%A8%B9%E7%8B%80%E7%B5%90%E6%A7%8B%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E7%9B%B8%E5%90%8C%E7%9A%84%20XamlRoot%E3%80%82)，否則會拋出錯誤訊息（例如"_This element is already associated with a XamlRoot_"）[\[2\]](https://stackoverflow.com/questions/74370791/c-sharp-winui-3-desktop-application-issue-with-contentdialog-and-the-xamlroot#:~:text=Exception%20thrown%20at%200x00007FFFD5FE3FA9%20%28KernelBase,removed%20from%20the%20previous%20XamlRoot)。一開始沒注意到這點，就可能導致對話框無法彈出。對於系統還原功能本身，Windows 提供了 **SRSetRestorePoint** 之類的 Win32 API，以及對應的 WMI 類別[\[3\]](https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api#:~:text=%E6%9C%AC%E6%96%87%E5%85%A7%E5%AE%B9)。然而，系統還原點有時效限制（新點最多只保留60天）[\[3\]](https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api#:~:text=%E6%9C%AC%E6%96%87%E5%85%A7%E5%AE%B9)，而且必須以**管理員權限**執行才能成功建立還原點[\[4\]](https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point#:~:text=To%20create%20a%20restore%20point%2C,you%20must%20have%20administrator%20rights)。這意味著應用程式要做系統還原點時，必須先取得提升權限。例如，StackOverflow 上就指出「要創建還原點必須具有管理員權限」[\[4\]](https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point#:~:text=To%20create%20a%20restore%20point%2C,you%20must%20have%20administrator%20rights)。此外，在封裝為 MSIX 或 UWP 應用後，由於 Windows 應用沙箱限制，直接呼叫 WMI 或 COM 類別常被拒絕，需要透過 runFullTrust 等機制（也就是用桌面橋接或外部進程）來實現[\[5\]](https://learn.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations#:~:text=But%20there%20are%20some%20scenarios,support%20for%20the%20Desktop%20Bridge)[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。

在**多語系支援**方面，WinUI 3 也不算輕鬆。需要為每種語言準備獨立的 .resw 檔案（放在 Strings\\xx-XX 資料夾）並以 x:Uid 或 ms-resource 來引用。每次修改資源後，必須使用 **MakePri.exe** 重新生成 .pri 索引，否則新的字串不會生效。微軟文件建議以後製腳本自動執行 MakePri，並將輸出的 resources.pri 拷貝到輸出目錄[\[7\]](https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/mrtcore/localize-strings#:~:text=recommend%20using%20a%20post,exe%20directory)。遺憾的是，WinUI 3 現階段只支援在應用啟動時套用系統語系，無法像行動框架那樣隨時熱切換。正如社群在 V2EX 上所說：「按照官方文檔做完這些，程式開啟時只能定好區域，無法動態修改」[\[8\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%8C%89%E7%85%A7%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%9A%84%E8%AF%B4%E6%B3%95%EF%BC%8C%E8%A6%81%E5%85%88%E6%8A%8A%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%98%E5%88%B0%20resw%20%E6%96%87%E4%BB%B6%E9%87%8C%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%20XAML%20%E9%87%8C%E5%BC%95%E7%94%A8,x%3AUid%20%EF%BC%8C%E7%A8%8B%E5%BA%8F%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E7%B3%BB%E7%BB%9F%E5%8C%BA%E5%9F%9F%E8%87%AA%E5%8A%A8%E8%AF%86%E5%88%AB%E4%BA%86%E3%80%82)。如果要實現動態換語言，只好自行用 ApplicationLanguages.PrimaryLanguageOverride 再配合重載頁面，或用 ResourceLoader 手動逐個更新 UI 字串。這類折衷方案比較繁瑣，也是開發者常踩雷的地方。

封裝與權限也是一大挑戰。WinUI 3 桌面應用預設採用**Full-Trust**模型，因此在 Package.appxmanifest 中通常自帶 &lt;rescap:Capability Name="runFullTrust"/&gt;[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。也就是說，發佈到 Microsoft Store 時，系統會認為你使用了受限能力，要求提供理由[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。事實上，微軟官方說「WinUI 3 應用使用全權桌面模型（full-trust），包清單若包含受限能力 runFullTrust，在提交時必須額外回答問題」[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。如果打包過程中遇到奇怪的資源錯誤，也有官方對策。例如，有時編譯會出現 MSB4018 或 PRI 資源生成錯誤，微軟文檔建議在專案屬性中禁用自動生成 PRI：  

&lt;AppxGeneratePrisForPortableLibrariesEnabled&gt;false&lt;/AppxGeneratePrisForPortableLibrariesEnabled&gt;

這可避免 MSB4018「GenerateResource 任務失敗」錯誤[\[9\]](https://learn.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-known-issues#:~:text=This%20can%20happen%20when%20trying,PRI%29%20files)。此外，我們實測過程中也碰到過莫名其妙的 resources.pri 無法複製錯誤（DirectoryNotFoundException），最後不得不整個重建專案才解決[\[10\]](https://stackoverflow.com/questions/72066002/winui3-build-started-failing-randomly-giving-a-odd-error-about-resources-pri#:~:text=Judging%20from%20the%20error%2C%20the,correctly%20when%20it%20was%20run)。總之，MSIX 打包往往有各種陷阱，包含簽章、證書、權限等要逐一排查。

## 微軟平台觀察與反思

從這次專案看 WinUI 3 和 Windows App SDK 的狀況，發現它雖然帶來現代化 UI 框架，但整體開發體驗仍有待改進。社群評論 WinUI 3 時經常提到：**開發體驗差**（目前無直觀設計器，只能靠寫 XAML，編譯速度又很慢）、**安裝包體積大**（一個空的 WinUI 3 C# 應用就已有 40MB 以上[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82)）、**互操作性能差**（因 CsWinRT 互調開銷大）[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82)、**第三方生態欠佳**（正式發佈未滿一年，可用的控件很少）[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82)。這些缺點讓人感覺 WinUI 3 還沒準備好做生產力工具。不少開發者吐槽：桌面端的開發體驗根本比不上行動端框架的熱重載和即時預覽，用 WinUI 3 改東西竟要重啟應用，讓人「硬邦邦」[\[12\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%9C%80%E5%90%8E%E6%88%91%E6%83%B3%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%80%AA%E4%B8%8D%E5%BE%97%E7%8E%B0%E5%9C%A8%E8%AF%B4%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B2%A1%E4%BA%BA%E5%BC%80%E5%8F%91%E4%BA%86%EF%BC%8C%E6%84%9F%E8%A7%89%E5%85%89%E4%BB%8E%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BE%BF%E5%88%A9%E6%80%A7%E4%B8%8A%E5%B0%B1%E8%A2%AB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%8C%E7%88%86%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%90%84%E7%A7%8D%E7%83%AD%E9%87%8D%E8%BD%BD%E8%BE%B9%E6%94%B9%E8%BE%B9%E7%9C%8B%EF%BC%8C%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C%E4%B8%9D%E8%88%AC%E6%B6%A6%E6%BB%91%EF%BC%8C%E7%82%B9%E5%90%8D%E8%A1%A8%E6%89%AC%20flutter%20%E3%80%82%E6%A1%8C%E9%9D%A2%E7%AB%AF%20winui3%20%E7%A8%8D%E5%BE%AE%E6%94%B9%E7%82%B9%E4%B8%9C%E8%A5%BF%E7%A8%8B%E5%BA%8F%E5%B0%B1%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E5%90%AF%EF%BC%8C%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E8%BF%98%E8%B4%BC%E6%85%A2%EF%BC%8C%E8%AF%B4%E6%98%AF%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E4%BD%86%E6%98%AF%E5%90%84%E7%A7%8D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B9%9F%E4%B8%8D%E8%88%92%E6%9C%8D%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%B0%B1%E6%98%AF%E7%BB%99%E4%BA%BA%E4%B8%80%E7%A7%8D%E7%A1%AC%E9%82%A6%E9%82%A6%E7%9A%84%E6%84%9F%E8%A7%89%E3%80%82%E5%B0%B1%E8%BF%99%E7%A7%8D%E4%BD%93%E9%AA%8C%EF%BC%8C%E8%83%BD%E6%AF%94%E4%BA%BA%E5%AE%B6%E5%A5%BD%E6%89%8D%E6%80%AA%E4%BA%86%E3%80%82)。而且，微軟近期才宣布將 WinUI 3 原始碼「真正開源」，但進展龜速[\[13\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Actually%2C%20the%20title%20of%20the,repo)，不少人已笑稱「連微軟自己都沒用它，叫我們怎麼用？」[\[14\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=However%2C%20recently%2C%20many%20developers%20have,the%20community%20to%20use%20it)。

對於 Microsoft Store 和應用沙箱政策的觀察：Store 對 runFullTrust 的審核非常嚴格，我們必須在提交時說明為何需要此權限[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。即便 WinUI 3 不算 UWP，但凡打包為 APPX 就等於自帶了全權能力。這使得開發者常要妥協，比如有經驗的同學抱怨：「根本無法去除這個設置，發佈時只能跟審核員解釋『這是官方 msix 打包機制』[\[15\]](https://stackoverflow.com/questions/77764786/remove-runfulltrust-capability-from-flutter-windows-application#:~:text=I%27ve%20just%20published%20my%20flutter,following%20explanation%20to%20the%20reviewer)。」對於原始的 WMI 或 COM 接口，則只能通過引入 runFullTrust 的 Out-Of-Process COM 或 Powershell 來間接使用（等於變相叫系統做事），無形中大大增添了複雜度。此外，桌面應用現在有 WinForms、WPF、UWP、WinUI、控制台等多種技術並存，缺乏單一統一方向。正如外媒所評價的：「每隔幾年就推出新技術，很多最後被廢棄；名字和路線頻繁變化，讓人摸不著頭緒」[\[16\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Every%20few%20years%2C%20Microsoft%20launches,is%20just%20one%20factor)。這種分裂現象讓開發者對未來路線更感疑惑，也增添了選擇成本。

## 綜合觀點與社群語氣

總的來說，這次專案既讓我們體驗到 WinUI 3 的一些優點（現代化風格、Fluent 控件等），也暴露了諸多不一致之處。在忍耐一堆配置、權限、編譯慢等問題的同時，難免對微軟的技術路線生出不信任感。不少開發者調侃：為了實現一個系統還原的功能 UI，竟要「召喚出 COM、Powershell、manifest 才能執行」，感覺搞得像在召喚神獸一般。社群上常見的抱怨包括「WinUI 3 穩定性不夠」、「官方文件過時模糊」等，比如有人說「桌面端 WinUI 3 稍微改點東西程式就要完全重啟，還驚訝啟動速度慢，使用體驗簡直硬邦邦」[\[12\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%9C%80%E5%90%8E%E6%88%91%E6%83%B3%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%80%AA%E4%B8%8D%E5%BE%97%E7%8E%B0%E5%9C%A8%E8%AF%B4%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B2%A1%E4%BA%BA%E5%BC%80%E5%8F%91%E4%BA%86%EF%BC%8C%E6%84%9F%E8%A7%89%E5%85%89%E4%BB%8E%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BE%BF%E5%88%A9%E6%80%A7%E4%B8%8A%E5%B0%B1%E8%A2%AB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%8C%E7%88%86%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%90%84%E7%A7%8D%E7%83%AD%E9%87%8D%E8%BD%BD%E8%BE%B9%E6%94%B9%E8%BE%B9%E7%9C%8B%EF%BC%8C%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C%E4%B8%9D%E8%88%AC%E6%B6%A6%E6%BB%91%EF%BC%8C%E7%82%B9%E5%90%8D%E8%A1%A8%E6%89%AC%20flutter%20%E3%80%82%E6%A1%8C%E9%9D%A2%E7%AB%AF%20winui3%20%E7%A8%8D%E5%BE%AE%E6%94%B9%E7%82%B9%E4%B8%9C%E8%A5%BF%E7%A8%8B%E5%BA%8F%E5%B0%B1%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E5%90%AF%EF%BC%8C%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E8%BF%98%E8%B4%BC%E6%85%A2%EF%BC%8C%E8%AF%B4%E6%98%AF%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E4%BD%86%E6%98%AF%E5%90%84%E7%A7%8D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B9%9F%E4%B8%8D%E8%88%92%E6%9C%8D%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%B0%B1%E6%98%AF%E7%BB%99%E4%BA%BA%E4%B8%80%E7%A7%8D%E7%A1%AC%E9%82%A6%E9%82%A6%E7%9A%84%E6%84%9F%E8%A7%89%E3%80%82%E5%B0%B1%E8%BF%99%E7%A7%8D%E4%BD%93%E9%AA%8C%EF%BC%8C%E8%83%BD%E6%AF%94%E4%BA%BA%E5%AE%B6%E5%A5%BD%E6%89%8D%E6%80%AA%E4%BA%86%E3%80%82)。甚至有觀察指出，WinUI 3 目前根本不是微軟內部首選技術，「連微軟自己都沒用它，還叫社群用？」[\[14\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=However%2C%20recently%2C%20many%20developers%20have,the%20community%20to%20use%20it)。面對這些，開發者常會半開玩笑半無奈地形容：「哎，這些技術弄得真複雜，到頭來還不是要自己想辦法吃案子。」

**小結：** WinUI 3 與系統還原工具的開發經歷告訴我們：固然可以打造現代化的應用體驗，但也要準備好面對 SDK 的各種限制與坑。從核心 API 權限、沙箱限制，到翻新不久的 UI 框架，整個過程中不斷調適與迂迴。對微軟平台而言，希望這些反思能引導改進：提供更好的開發工具與文件、簡化上架要求、統一桌面開發路線，而不是讓開發者「被 WinUI3 害到內傷」般叫苦不迭。只有這樣，Windows 桌面生態才能真正恢復開發者的信心與活力。

**參考資料：** 微軟官方文檔、StackOverflow 社群討論、開發者經驗分享等[\[1\]](https://learn.microsoft.com/zh-tw/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.contentdialog?view=windows-app-sdk-1.6#:~:text=%E7%95%B6%E6%82%A8%E9%A1%AF%E7%A4%BA%20ContentDialog%20%E6%99%82%EF%BC%8C%E6%82%A8%E5%BF%85%E9%A0%88%E6%89%8B%E5%8B%95%E5%B0%87%E5%B0%8D%E8%A9%B1%E6%A1%86%E7%9A%84%20XamlRoot%20%E8%A8%AD%E5%AE%9A%E7%82%BA,XamlRoot%20%E5%B1%AC%E6%80%A7%E8%A8%AD%E5%AE%9A%E7%82%BA%E8%88%87%E5%B7%B2%E5%9C%A8%20XAML%20%E6%A8%B9%E7%8B%80%E7%B5%90%E6%A7%8B%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E7%9B%B8%E5%90%8C%E7%9A%84%20XamlRoot%E3%80%82)[\[2\]](https://stackoverflow.com/questions/74370791/c-sharp-winui-3-desktop-application-issue-with-contentdialog-and-the-xamlroot#:~:text=Exception%20thrown%20at%200x00007FFFD5FE3FA9%20%28KernelBase,removed%20from%20the%20previous%20XamlRoot)[\[3\]](https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api#:~:text=%E6%9C%AC%E6%96%87%E5%85%A7%E5%AE%B9)[\[4\]](https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point#:~:text=To%20create%20a%20restore%20point%2C,you%20must%20have%20administrator%20rights)[\[7\]](https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/mrtcore/localize-strings#:~:text=recommend%20using%20a%20post,exe%20directory)[\[10\]](https://stackoverflow.com/questions/72066002/winui3-build-started-failing-randomly-giving-a-odd-error-about-resources-pri#:~:text=Judging%20from%20the%20error%2C%20the,correctly%20when%20it%20was%20run)[\[9\]](https://learn.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-known-issues#:~:text=This%20can%20happen%20when%20trying,PRI%29%20files)[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82)[\[8\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%8C%89%E7%85%A7%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%9A%84%E8%AF%B4%E6%B3%95%EF%BC%8C%E8%A6%81%E5%85%88%E6%8A%8A%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%98%E5%88%B0%20resw%20%E6%96%87%E4%BB%B6%E9%87%8C%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%20XAML%20%E9%87%8C%E5%BC%95%E7%94%A8,x%3AUid%20%EF%BC%8C%E7%A8%8B%E5%BA%8F%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E7%B3%BB%E7%BB%9F%E5%8C%BA%E5%9F%9F%E8%87%AA%E5%8A%A8%E8%AF%86%E5%88%AB%E4%BA%86%E3%80%82)[\[12\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%9C%80%E5%90%8E%E6%88%91%E6%83%B3%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%80%AA%E4%B8%8D%E5%BE%97%E7%8E%B0%E5%9C%A8%E8%AF%B4%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B2%A1%E4%BA%BA%E5%BC%80%E5%8F%91%E4%BA%86%EF%BC%8C%E6%84%9F%E8%A7%89%E5%85%89%E4%BB%8E%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BE%BF%E5%88%A9%E6%80%A7%E4%B8%8A%E5%B0%B1%E8%A2%AB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%8C%E7%88%86%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%90%84%E7%A7%8D%E7%83%AD%E9%87%8D%E8%BD%BD%E8%BE%B9%E6%94%B9%E8%BE%B9%E7%9C%8B%EF%BC%8C%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C%E4%B8%9D%E8%88%AC%E6%B6%A6%E6%BB%91%EF%BC%8C%E7%82%B9%E5%90%8D%E8%A1%A8%E6%89%AC%20flutter%20%E3%80%82%E6%A1%8C%E9%9D%A2%E7%AB%AF%20winui3%20%E7%A8%8D%E5%BE%AE%E6%94%B9%E7%82%B9%E4%B8%9C%E8%A5%BF%E7%A8%8B%E5%BA%8F%E5%B0%B1%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E5%90%AF%EF%BC%8C%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E8%BF%98%E8%B4%BC%E6%85%A2%EF%BC%8C%E8%AF%B4%E6%98%AF%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E4%BD%86%E6%98%AF%E5%90%84%E7%A7%8D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B9%9F%E4%B8%8D%E8%88%92%E6%9C%8D%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%B0%B1%E6%98%AF%E7%BB%99%E4%BA%BA%E4%B8%80%E7%A7%8D%E7%A1%AC%E9%82%A6%E9%82%A6%E7%9A%84%E6%84%9F%E8%A7%89%E3%80%82%E5%B0%B1%E8%BF%99%E7%A7%8D%E4%BD%93%E9%AA%8C%EF%BC%8C%E8%83%BD%E6%AF%94%E4%BA%BA%E5%AE%B6%E5%A5%BD%E6%89%8D%E6%80%AA%E4%BA%86%E3%80%82)[\[16\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Every%20few%20years%2C%20Microsoft%20launches,is%20just%20one%20factor)[\[14\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=However%2C%20recently%2C%20many%20developers%20have,the%20community%20to%20use%20it)[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。

[\[1\]](https://learn.microsoft.com/zh-tw/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.contentdialog?view=windows-app-sdk-1.6#:~:text=%E7%95%B6%E6%82%A8%E9%A1%AF%E7%A4%BA%20ContentDialog%20%E6%99%82%EF%BC%8C%E6%82%A8%E5%BF%85%E9%A0%88%E6%89%8B%E5%8B%95%E5%B0%87%E5%B0%8D%E8%A9%B1%E6%A1%86%E7%9A%84%20XamlRoot%20%E8%A8%AD%E5%AE%9A%E7%82%BA,XamlRoot%20%E5%B1%AC%E6%80%A7%E8%A8%AD%E5%AE%9A%E7%82%BA%E8%88%87%E5%B7%B2%E5%9C%A8%20XAML%20%E6%A8%B9%E7%8B%80%E7%B5%90%E6%A7%8B%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E7%9B%B8%E5%90%8C%E7%9A%84%20XamlRoot%E3%80%82) ContentDialog 類別 (Microsoft.UI.Xaml.Controls) - Windows App SDK | Microsoft Learn

<https://learn.microsoft.com/zh-tw/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.contentdialog?view=windows-app-sdk-1.6>

[\[2\]](https://stackoverflow.com/questions/74370791/c-sharp-winui-3-desktop-application-issue-with-contentdialog-and-the-xamlroot#:~:text=Exception%20thrown%20at%200x00007FFFD5FE3FA9%20%28KernelBase,removed%20from%20the%20previous%20XamlRoot) C# WinUI 3 Desktop Application Issue with ContentDialog and the XamlRoot - Stack Overflow

<https://stackoverflow.com/questions/74370791/c-sharp-winui-3-desktop-application-issue-with-contentdialog-and-the-xamlroot>

[\[3\]](https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api#:~:text=%E6%9C%AC%E6%96%87%E5%85%A7%E5%AE%B9) 系統還原 API - Win32 apps | Microsoft Learn

<https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api>

[\[4\]](https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point#:~:text=To%20create%20a%20restore%20point%2C,you%20must%20have%20administrator%20rights) c - SRSetRestorePoint does not create a restore point - Stack Overflow

<https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point>

[\[5\]](https://learn.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations#:~:text=But%20there%20are%20some%20scenarios,support%20for%20the%20Desktop%20Bridge) App capability declarations - UWP applications | Microsoft Learn

<https://learn.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations>

[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store) Do WinUI applications need runFullTrust to publish to the Windows Store? - Stack Overflow

<https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store>

[\[7\]](https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/mrtcore/localize-strings#:~:text=recommend%20using%20a%20post,exe%20directory) Localize strings in your UI and app package manifest - Windows apps | Microsoft Learn

<https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/mrtcore/localize-strings>

[\[8\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%8C%89%E7%85%A7%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%9A%84%E8%AF%B4%E6%B3%95%EF%BC%8C%E8%A6%81%E5%85%88%E6%8A%8A%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%98%E5%88%B0%20resw%20%E6%96%87%E4%BB%B6%E9%87%8C%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%20XAML%20%E9%87%8C%E5%BC%95%E7%94%A8,x%3AUid%20%EF%BC%8C%E7%A8%8B%E5%BA%8F%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E7%B3%BB%E7%BB%9F%E5%8C%BA%E5%9F%9F%E8%87%AA%E5%8A%A8%E8%AF%86%E5%88%AB%E4%BA%86%E3%80%82) [\[12\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%9C%80%E5%90%8E%E6%88%91%E6%83%B3%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%80%AA%E4%B8%8D%E5%BE%97%E7%8E%B0%E5%9C%A8%E8%AF%B4%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B2%A1%E4%BA%BA%E5%BC%80%E5%8F%91%E4%BA%86%EF%BC%8C%E6%84%9F%E8%A7%89%E5%85%89%E4%BB%8E%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BE%BF%E5%88%A9%E6%80%A7%E4%B8%8A%E5%B0%B1%E8%A2%AB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%8C%E7%88%86%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%90%84%E7%A7%8D%E7%83%AD%E9%87%8D%E8%BD%BD%E8%BE%B9%E6%94%B9%E8%BE%B9%E7%9C%8B%EF%BC%8C%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C%E4%B8%9D%E8%88%AC%E6%B6%A6%E6%BB%91%EF%BC%8C%E7%82%B9%E5%90%8D%E8%A1%A8%E6%89%AC%20flutter%20%E3%80%82%E6%A1%8C%E9%9D%A2%E7%AB%AF%20winui3%20%E7%A8%8D%E5%BE%AE%E6%94%B9%E7%82%B9%E4%B8%9C%E8%A5%BF%E7%A8%8B%E5%BA%8F%E5%B0%B1%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E5%90%AF%EF%BC%8C%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E8%BF%98%E8%B4%BC%E6%85%A2%EF%BC%8C%E8%AF%B4%E6%98%AF%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E4%BD%86%E6%98%AF%E5%90%84%E7%A7%8D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B9%9F%E4%B8%8D%E8%88%92%E6%9C%8D%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%B0%B1%E6%98%AF%E7%BB%99%E4%BA%BA%E4%B8%80%E7%A7%8D%E7%A1%AC%E9%82%A6%E9%82%A6%E7%9A%84%E6%84%9F%E8%A7%89%E3%80%82%E5%B0%B1%E8%BF%99%E7%A7%8D%E4%BD%93%E9%AA%8C%EF%BC%8C%E8%83%BD%E6%AF%94%E4%BA%BA%E5%AE%B6%E5%A5%BD%E6%89%8D%E6%80%AA%E4%BA%86%E3%80%82) 关于 winui3 本地化功能的一些看法，欢迎讨论 - V2EX

<https://cn.v2ex.com/t/1116798>

[\[9\]](https://learn.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-known-issues#:~:text=This%20can%20happen%20when%20trying,PRI%29%20files) Known Issues with packaged desktop apps - MSIX | Microsoft Learn

<https://learn.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-known-issues>

[\[10\]](https://stackoverflow.com/questions/72066002/winui3-build-started-failing-randomly-giving-a-odd-error-about-resources-pri#:~:text=Judging%20from%20the%20error%2C%20the,correctly%20when%20it%20was%20run) c# - WinUI3 build started failing randomly giving a odd error about resources.pri - Stack Overflow

<https://stackoverflow.com/questions/72066002/winui3-build-started-failing-randomly-giving-a-odd-error-about-resources-pri>

[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82) GitHub - Scighost/WinUI3Keng: WinUI 3 踩坑记

<https://github.com/Scighost/WinUI3Keng>

[\[13\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Actually%2C%20the%20title%20of%20the,repo) [\[14\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=However%2C%20recently%2C%20many%20developers%20have,the%20community%20to%20use%20it) [\[16\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Every%20few%20years%2C%20Microsoft%20launches,is%20just%20one%20factor) Microsoft Officially Announces "Truly Open - Sourced" WinUI with 6,800 Stars After 17 - Month "Death" Declaration by Developers: Netizens Question Survival Strategy via External Support

<https://eu.36kr.com/en/p/3411202919747200>

[\[15\]](https://stackoverflow.com/questions/77764786/remove-runfulltrust-capability-from-flutter-windows-application#:~:text=I%27ve%20just%20published%20my%20flutter,following%20explanation%20to%20the%20reviewer) remove runFullTrust capability from flutter Windows application - Stack Overflow

<https://stackoverflow.com/questions/77764786/remove-runfulltrust-capability-from-flutter-windows-application>