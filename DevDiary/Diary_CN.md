# WinUI 3 + Windows 系统还原工具开发实战与微软平台反思

## 技术挑战与细节

在开发 WinUI 3 桌面应用时，我们遭遇了多项痛点。首先，XAML 控件有很多新规则，例如**ContentDialog** 必须手动设置 XamlRoot 才能显示[\[1\]](https://learn.microsoft.com/zh-tw/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.contentdialog?view=windows-app-sdk-1.6#:~:text=%E7%95%B6%E6%82%A8%E9%A1%AF%E7%A4%BA%20ContentDialog%20%E6%99%82%EF%BC%8C%E6%82%A8%E5%BF%85%E9%A0%88%E6%89%8B%E5%8B%95%E5%B0%87%E5%B0%8D%E8%A9%B1%E6%A1%86%E7%9A%84%20XamlRoot%20%E8%A8%AD%E5%AE%9A%E7%82%BA,XamlRoot%20%E5%B1%AC%E6%80%A7%E8%A8%AD%E5%AE%9A%E7%82%BA%E8%88%87%E5%B7%B2%E5%9C%A8%20XAML%20%E6%A8%B9%E7%8B%80%E7%B5%90%E6%A7%8B%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E7%9B%B8%E5%90%8C%E7%9A%84%20XamlRoot%E3%80%82)，否则会抛出错误消息（例如"_This element is already associated with a XamlRoot_"）[\[2\]](https://stackoverflow.com/questions/74370791/c-sharp-winui-3-desktop-application-issue-with-contentdialog-and-the-xamlroot#:~:text=Exception%20thrown%20at%200x00007FFFD5FE3FA9%20%28KernelBase,removed%20from%20the%20previous%20XamlRoot)。一开始没注意到这点，就可能导致对话框无法弹出。对于系统还原功能本身，Windows 提供了 **SRSetRestorePoint** 之类的 Win32 API，以及对应的 WMI 类[\[3\]](https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api#:~:text=%E6%9C%AC%E6%96%87%E5%85%A7%E5%AE%B9)。然而，系统还原点有时效限制（新点最多只保留60天）[\[3\]](https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api#:~:text=%E6%9C%AC%E6%96%87%E5%85%A7%E5%AE%B9)，而且必须以**管理员权限**执行才能成功建立还原点[\[4\]](https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point#:~:text=To%20create%20a%20restore%20point%2C,you%20must%20have%20administrator%20rights)。这意味着应用程序要做系统还原点时，必须先取得提升权限。例如，StackOverflow 上就指出「要创建还原点必须具有管理员权限」[\[4\]](https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point#:~:text=To%20create%20a%20restore%20point%2C,you%20must%20have%20administrator%20rights)。此外，在封装为 MSIX 或 UWP 应用后，由于 Windows 应用沙箱限制，直接调用 WMI 或 COM 类常被拒绝，需要通过 runFullTrust 等机制（也就是用桌面桥接或外部进程）来实现[\[5\]](https://learn.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations#:~:text=But%20there%20are%20some%20scenarios,support%20for%20the%20Desktop%20Bridge)[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。

在**多语系支援**方面，WinUI 3 也不算轻松。需要为每种语言准备独立的 .resw 文件（放在 Strings\\xx-XX 资料夹）并以 x:Uid 或 ms-resource 来引用。每次修改资源后，必须使用 **MakePri.exe** 重新生成 .pri 索引，否则新的字符串不会生效。微软文档建议以后制脚本自动执行 MakePri，并将输出的 resources.pri 拷贝到输出目录[\[7\]](https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/mrtcore/localize-strings#:~:text=recommend%20using%20a%20post,exe%20directory)。遗憾的是，WinUI 3 现阶段只支援在应用启动时套用系统语系，无法像行动框架那样随时热切换。正如社群在 V2EX 上所说：「按照官方文档的说法，要先把字符串存到 resw 文件里，然后在 XAML 里引用 x:Uid ，程序就可以根据系统区域自动识别了。」如果要实现动态换语言，只好自行用 ApplicationLanguages.PrimaryLanguageOverride 再配合重载页面，或用 ResourceLoader 手动逐个更新 UI 字符串。这类折衷方案比较繁琐，也是开发者常踩雷的地方。

封装与权限也是一大挑战。WinUI 3 桌面应用预设采用**Full-Trust**模型，因此在 Package.appxmanifest 中通常自带 &lt;rescap:Capability Name="runFullTrust"/&gt;[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。也就是说，发佈到 Microsoft Store 时，系统会认为你使用了受限能力，要求提供理由[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。事实上，微软官方说「WinUI 3 应用使用全权桌面模型（full-trust），包清单若包含受限能力 runFullTrust，在提交时必须额外回答问题」[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。如果打包过程中遇到奇怪的资源错误，也有官方对策。例如，有时编译会出现 MSB4018 或 PRI 资源生成错误，微软文档建议在项目属性中禁用自动生成 PRI：

&lt;AppxGeneratePrisForPortableLibrariesEnabled&gt;false&lt;/AppxGeneratePrisForPortableLibrariesEnabled&gt;

这可避免 MSB4018「GenerateResource 任务失败」错误[\[9\]](https://learn.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-known-issues#:~:text=This%20can%20happen%20when%20trying,PRI%29%20files)。此外，我们实测过程中也碰到过莫名其妙的 resources.pri 无法复制错误（DirectoryNotFoundException），最后不得不整个重建项目才解决[\[10\]](https://stackoverflow.com/questions/72066002/winui3-build-started-failing-randomly-giving-a-odd-error-about-resources-pri#:~:text=Judging%20from%20the%20error%2C%20the,correctly%20when%20it%20was%20run)。

总之，MSIX 打包往往有各种陷阱，包含签名、证书、权限等要逐一排查。

## 微软平台观察与反思

从这次项目看 WinUI 3 和 Windows App SDK 的状况，发现它虽然带来现代化 UI 框架，但整体开发体验仍有待改进。社群评论 WinUI 3 时经常提到：**开发体验差**（目前无直观设计器，只能靠写 XAML，编译速度又很慢）、**安装包体积大**（一个空的 WinUI 3 C# 应用就有 40MB 以上[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82)）、**互操作性能差**（因 CsWinRT 互调开销大）[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82)、**第三方生态欠佳**（正式发布未满一年，可用的控件很少）[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82)。这些缺点让人感觉 WinUI 3 还没准备好做生产力工具。不少开发者吐槽：桌面端的开发体验根本比不上行动端框架的热重载和即时预览，用 WinUI 3 改东西竟要重启应用，让人「硬邦邦」[\[12\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%9C%80%E5%90%8E%E6%88%91%E6%83%B3%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%80%AA%E4%B8%8D%E5%BE%97%E7%8E%B0%E5%9C%A8%E8%AF%B4%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B2%A1%E4%BA%BA%E5%BC%80%E5%8F%91%E4%BA%86%EF%BC%8C%E6%84%9F%E8%A7%89%E5%85%89%E4%BB%8E%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BE%BF%E5%88%A9%E6%80%A7%E4%B8%8A%E5%B0%B1%E8%A2%AB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%8C%E7%88%86%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%90%84%E7%A7%8D%E7%83%AD%E9%87%8D%E8%BD%BD%E8%BE%B9%E6%94%B9%E8%BE%B9%E7%9C%8B%EF%BC%8C%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C%E4%B8%9D%E8%88%AC%E6%B6%A6%E6%BB%91%EF%BC%8C%E7%82%B9%E5%90%8D%E8%A1%A8%E6%89%AC%20flutter%20%E3%80%82%E6%A1%8C%E9%9D%A2%E7%AB%AF%20winui3%20%E7%A8%8D%E5%BE%AE%E6%94%B9%E7%82%B9%E4%B8%9C%E8%A5%BF%E7%A8%8B%E5%BA%8F%E5%B0%B1%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E5%90%AF%EF%BC%8C%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E8%BF%98%E8%B4%BC%E6%85%A2%EF%BC%8C%E8%AF%B4%E6%98%AF%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E4%BD%86%E6%98%AF%E5%90%84%E7%A7%8D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B9%9F%E4%B8%8D%E8%88%92%E6%9C%8D%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%B0%B1%E6%98%AF%E7%BB%99%E4%BA%BA%E4%B8%80%E7%A7%8D%E7%A1%AC%E9%82%A6%E9%82%A6%E7%9A%84%E6%84%9F%E8%A7%89%E3%80%82%E5%B0%B1%E8%BF%99%E7%A7%8D%E4%BD%93%E9%AA%8C%EF%BC%8C%E8%83%BD%E6%AF%94%E4%BA%BA%E5%AE%B6%E5%A5%BD%E6%89%8D%E6%80%AA%E4%BA%86%E3%80%82)。而且，微软近期才宣布将 WinUI 3 原始码「真正开源」，但进展龟速[\[13\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Actually%2C%20the%20title%20of%20the,repo)，不少人已笑称「连微软自己都没用它，叫我们怎么用？」[\[14\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=However%2C%20recently%2C%20many%20developers%20have,the%20community%20to%20use%20it)。

对于 Microsoft Store 和应用沙箱政策的观察：Store 对 runFullTrust 的审核非常严格，我们必须在提交时说明为何需要此权限[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。即便 WinUI 3 不算 UWP，但凡打包为 APPX 就等于自带了全权能力。这使得开发者常要妥协，比如有经验的同学抱怨：「根本无法去除这个设置，发佈时只能跟审核员解释『这是官方 msix 打包机制』[\[15\]](https://stackoverflow.com/questions/77764786/remove-runfulltrust-capability-from-flutter-windows-application#:~:text=I%27ve%20just%20published%20my%20flutter,following%20explanation%20to%20the%20reviewer)。」对于原始的 WMI 或 COM 接口，则只能通过引入 runFullTrust 的 Out-Of-Process COM 或 Powershell 来间接使用（等于变相叫系统做事），无形中大大增添了复杂度。此外，桌面应用现在有 WinForms、WPF、UWP、WinUI、控制台等多项技术并存，缺乏单一统一方向。正如外媒所评价的：「每隔几年就推出新技术，很多最后被废弃；名字和路线频繁变化，让人摸不着头脑」[\[16\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Every%20few%20years%2C%20Microsoft%20launches,is%20just%20one%20factor)。这种分裂现象让开发者对未来路线更感疑惑，也增添了选择成本。

## 综合观点与社群语气

总的来说，这次项目既让我们体验到 WinUI 3 的一些优点（现代化风格、Fluent 控件等），也暴露了诸多不一致之处。在忍耐一堆配置、权限、编译慢等问题的同时，难免对微软的技术路线生出不信任感。不少开发者调侃：为了实现一个系统还原的功能 UI，竟要「召唤出 COM、Powershell、manifest 才能执行」，感觉搞得像在召唤神兽一般。社群上常见抱怨包括「WinUI 3 稳定性不够」、「官方文件过时模糊」等，比如有人说「桌面端 WinUI 3 稍微改点东西程序就要完全重启，还惊讶启动速度慢，使用体验简直硬邦邦」[\[12\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%9C%80%E5%90%8E%E6%88%91%E6%83%B3%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%80%AA%E4%B8%8D%E5%BE%97%E7%8E%B0%E5%9C%A8%E8%AF%B4%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B2%A1%E4%BA%BA%E5%BC%80%E5%8F%91%E4%BA%86%EF%BC%8C%E6%84%9F%E8%A7%89%E5%85%89%E4%BB%8E%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BE%BF%E5%88%A9%E6%80%A7%E4%B8%8A%E5%B0%B1%E8%A2%AB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%8C%E7%88%86%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%90%84%E7%A7%8D%E7%83%AD%E9%87%8D%E8%BD%BD%E8%BE%B9%E6%94%B9%E8%BE%B9%E7%9C%8B%EF%BC%8C%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C%E4%B8%9D%E8%88%AC%E6%B6%A6%E6%BB%91%EF%BC%8C%E7%82%B9%E5%90%8D%E8%A1%A8%E6%89%AC%20flutter%20%E3%80%82%E6%A1%8C%E9%9D%A2%E7%AB%AF%20winui3%20%E7%A8%8D%E5%BE%AE%E6%94%B9%E7%82%B9%E4%B8%9C%E8%A5%BF%E7%A8%8B%E5%BA%8F%E5%B0%B1%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E5%90%AF%EF%BC%8C%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E8%BF%98%E8%B4%BC%E6%85%A2%EF%BC%8C%E8%AF%B4%E6%98%AF%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E4%BD%86%E6%98%AF%E5%90%84%E7%A7%8D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B9%9F%E4%B8%8D%E8%88%92%E6%9C%8D%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%B0%B1%E6%98%AF%E7%BB%99%E4%BA%BA%E4%B8%80%E7%A7%8D%E7%A1%AC%E9%82%A6%E9%82%A6%E7%9A%84%E6%84%9F%E8%A7%89%E3%80%82%E5%B0%B1%E8%BF%99%E7%A7%8D%E4%BD%93%E9%AA%8C%EF%BC%8C%E8%83%BD%E6%AF%94%E4%BA%BA%E5%AE%B6%E5%A5%BD%E6%89%8D%E6%80%AA%E4%BA%86%E3%80%82)。甚至有观察指出，WinUI 3 目前根本不是微软内部首选技术，「连微软自己都没用它，还叫社群用？」[\[14\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=However%2C%20recently%2C%20many%20developers%20have,the%20community%20to%20use%20it)。面对这些，开发者常会半开玩笑半无奈地形容：「哎，这些技术弄得真复杂，到头来还不是要自己想办法吃案子。」

**小结：** WinUI 3 与系统还原工具的开发经历告诉我们：固然可以打造现代化的应用体验，但也要准备好面对 SDK 的各种限制与坑。从核心 API 权限、沙箱限制，到翻新不久的 UI 框架，整个过程中不断调适与迂回。对微软平台而言，希望这些反思能引导改进：提供更好的开发工具与文件、简化上架要求、统一桌面开发路线，而不是让开发者「被 WinUI3 害到内伤」般叫苦不迭。只有这样，Windows 桌面生态才能真正恢复开发者的信心与活力。

**参考资料：** 微软官方文档、StackOverflow 社群讨论、开发者经验分享等[\[1\]](https://learn.microsoft.com/zh-tw/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.contentdialog?view=windows-app-sdk-1.6#:~:text=%E7%95%B6%E6%82%A8%E9%A1%AF%E7%A4%BA%20ContentDialog%20%E6%99%82%EF%BC%8C%E6%82%A8%E5%BF%85%E9%A0%88%E6%89%8B%E5%8B%95%E5%B0%87%E5%B0%8D%E8%A9%B1%E6%A1%86%E7%9A%84%20XamlRoot%20%E8%A8%AD%E5%AE%9A%E7%82%BA,XamlRoot%20%E5%B1%AC%E6%80%A7%E8%A8%AD%E5%AE%9A%E7%82%BA%E8%88%87%E5%B7%B2%E5%9C%A8%20XAML%20%E6%A8%B9%E7%8B%80%E7%B5%90%E6%A7%8B%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E7%9B%B8%E5%90%8C%E7%9A%84%20XamlRoot%E3%80%82)[\[2\]](https://stackoverflow.com/questions/74370791/c-sharp-winui-3-desktop-application-issue-with-contentdialog-and-the-xamlroot#:~:text=Exception%20thrown%20at%200x00007FFFD5FE3FA9%20%28KernelBase,removed%20from%20the%20previous%20XamlRoot)[\[3\]](https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api#:~:text=%E6%9C%AC%E6%96%87%E5%85%A7%E5%AE%B9)[\[4\]](https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point#:~:text=To%20create%20a%20restore%20point%2C,you%20must%20have%20administrator%20rights)[\[7\]](https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/mrtcore/localize-strings#:~:text=recommend%20using%20a%20post,exe%20directory)[\[10\]](https://stackoverflow.com/questions/72066002/winui3-build-started-failing-randomly-giving-a-odd-error-about-resources-pri#:~:text=Judging%20from%20the%20error%2C%20the,correctly%20when%20it%20was%20run)[\[9\]](https://learn.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-known-issues#:~:text=This%20can%20happen%20when%20trying,PRI%29%20files)[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82)[\[8\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%8C%89%E7%85%A7%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%9A%84%E8%AF%B4%E6%B3%95%EF%BC%8C%E8%A6%81%E5%85%88%E6%8A%8A%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%98%E5%88%B0%20resw%20%E6%96%87%E4%BB%B6%E9%87%8C%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%20XAML%20%E9%87%8C%E5%BC%95%E7%94%A8,x%3AUid%20%EF%BC%8C%E7%A8%8B%E5%BA%8F%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E7%B3%BB%E7%BB%9F%E5%8C%BA%E5%9F%9F%E8%87%AA%E5%8A%A8%E8%AF%86%E5%88%AB%E4%BA%86%E3%80%82)[\[12\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%9C%80%E5%90%8E%E6%88%91%E6%83%B3%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%80%AA%E4%B8%8D%E5%BE%97%E7%8E%B0%E5%9C%A8%E8%AF%B4%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B2%A1%E4%BA%BA%E5%BC%80%E5%8F%91%E4%BA%86%EF%BC%8C%E6%84%9F%E8%A7%89%E5%85%89%E4%BB%8E%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BE%BF%E5%88%A9%E6%80%A7%E4%B8%8A%E5%B0%B1%E8%A2%AB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%8C%E7%88%86%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%90%84%E7%A7%8D%E7%83%AD%E9%87%8D%E8%BD%BD%E8%BE%B9%E6%94%B9%E8%BE%B9%E7%9C%8B%EF%BC%8C%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C%E4%B8%9D%E8%88%AC%E6%B6%A6%E6%BB%91%EF%BC%8C%E7%82%B9%E5%90%8D%E8%A1%A8%E6%89%AC%20flutter%20%E3%80%82%E6%A1%8C%E9%9D%A2%E7%AB%AF%20winui3%20%E7%A8%8D%E5%BE%AE%E6%94%B9%E7%82%B9%E4%B8%9C%E8%A5%BF%E7%A8%8B%E5%BA%8F%E5%B0%B1%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E5%90%AF%EF%BC%8C%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E8%BF%98%E8%B4%BC%E6%85%A2%EF%BC%8C%E8%AF%B4%E6%98%AF%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E4%BD%86%E6%98%AF%E5%90%84%E7%A7%8D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B9%9F%E4%B8%8D%E8%88%92%E6%9C%8D%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%B0%B1%E6%98%AF%E7%BB%99%E4%BA%BA%E4%B8%80%E7%A7%8D%E7%A1%AC%E9%82%A6%E9%82%A6%E7%9A%84%E6%84%9F%E8%A7%89%E3%80%82%E5%B0%B1%E8%BF%99%E7%A7%8D%E4%BD%93%E9%AA%8C%EF%BC%8C%E8%83%BD%E6%AF%94%E4%BA%BA%E5%AE%B6%E5%A5%BD%E6%89%8D%E6%80%AA%E4%BA%86%E3%80%82)[\[16\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Every%20few%20years%2C%20Microsoft%20launches,is%20just%20one%20factor)[\[14\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=However%2C%20recently%2C%20many%20developers%20have,the%20community%20to%20use%20it)[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store)。

[\[1\]](https://learn.microsoft.com/zh-tw/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.contentdialog?view=windows-app-sdk-1.6#:~:text=%E7%95%B6%E6%82%A8%E9%A1%AF%E7%A4%BA%20ContentDialog%20%E6%99%82%EF%BC%8C%E6%82%A8%E5%BF%85%E9%A0%88%E6%89%8B%E5%8B%95%E5%B0%87%E5%B0%8D%E8%A9%B1%E6%A1%86%E7%9A%84%20XamlRoot%20%E8%A8%AD%E5%AE%9A%E7%82%BA,XamlRoot%20%E5%B1%AC%E6%80%A7%E8%A8%AD%E5%AE%9A%E7%82%BA%E8%88%87%E5%B7%B2%E5%9C%A8%20XAML%20%E6%A8%B9%E7%8B%80%E7%B5%90%E6%A7%8B%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E7%9B%B8%E5%90%8C%E7%9A%84%20XamlRoot%E3%80%82) ContentDialog 类 (Microsoft.UI.Xaml.Controls) - Windows App SDK | Microsoft Learn

<https://learn.microsoft.com/zh-tw/windows/windows-app-sdk/api/winrt/microsoft.ui.xaml.controls.contentdialog?view=windows-app-sdk-1.6>

[\[2\]](https://stackoverflow.com/questions/74370791/c-sharp-winui-3-desktop-application-issue-with-contentdialog-and-the-xamlroot#:~:text=Exception%20thrown%20at%200x00007FFFD5FE3FA9%20%28KernelBase,removed%20from%20the%20previous%20XamlRoot) C# WinUI 3 Desktop Application Issue with ContentDialog and the XamlRoot - Stack Overflow

<https://stackoverflow.com/questions/74370791/c-sharp-winui-3-desktop-application-issue-with-contentdialog-and-the-xamlroot>

[\[3\]](https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api#:~:text=%E6%9C%AC%E6%96%87%E5%85%A7%E5%AE%B9) 系统还原 API - Win32 apps | Microsoft Learn

<https://learn.microsoft.com/zh-tw/windows/win32/sr/system-restore-api>

[\[4\]](https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point#:~:text=To%20create%20a%20restore%20point%2C,you%20must%20have%20administrator%20rights) c - SRSetRestorePoint does not create a restore point - Stack Overflow

<https://stackoverflow.com/questions/71699499/srsetrestorepoint-does-not-create-a-restore-point>

[\[5\]](https://learn.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations#:~:text=But%20there%20are%20some%20scenarios,support%20for%20the%20Desktop%20Bridge) App capability declarations - UWP applications | Microsoft Learn

<https://learn.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations>

[\[6\]](https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store#:~:text=,publish%20to%20the%20Windows%20Store) Do WinUI applications need runFullTrust to publish to the Windows Store? - Stack Overflow

<https://stackoverflow.com/questions/72105566/do-winui-applications-need-runfulltrust-to-publish-to-the-windows-store>

[\[7\]](https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/mrtcore/localize-strings#:~:text=recommend%20using%20a%20post,exe%20directory) Localize strings in your UI and app package manifest - Windows apps | Microsoft Learn

<https://learn.microsoft.com/en-us/windows/apps/windows-app-sdk/mrtcore/localize-strings>

[\[8\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%8C%89%E7%85%A7%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%9A%84%E8%AF%B4%E6%B3%95%EF%BC%8C%E8%A6%81%E5%85%88%E6%8A%8A%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%AD%98%E5%88%B0%20resw%20%E6%96%87%E4%BB%B6%E9%87%8C%EF%BC%8C%E7%84%B6%E5%90%8E%E5%9C%A8%20XAML%20%E9%87%8C%E5%BC%95%E7%94%A8,x%3AUid%20%EF%BC%8C%E7%A8%8B%E5%BA%8F%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%A0%B9%E6%8D%AE%E7%B3%BB%E7%BB%9F%E5%8C%BA%E5%9F%9F%E8%87%AA%E5%8A%A8%E8%AF%86%E5%88%AB%E4%BA%86%E3%80%82) [\[12\]](https://cn.v2ex.com/t/1116798#:~:text=%E6%9C%80%E5%90%8E%E6%88%91%E6%83%B3%E5%90%90%E6%A7%BD%E4%B8%80%E4%B8%8B%EF%BC%8C%E6%80%AA%E4%B8%8D%E5%BE%97%E7%8E%B0%E5%9C%A8%E8%AF%B4%E6%A1%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B2%A1%E4%BA%BA%E5%BC%80%E5%8F%91%E4%BA%86%EF%BC%8C%E6%84%9F%E8%A7%89%E5%85%89%E4%BB%8E%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BE%BF%E5%88%A9%E6%80%A7%E4%B8%8A%E5%B0%B1%E8%A2%AB%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%AE%8C%E7%88%86%E4%BA%86%E3%80%82%E7%8E%B0%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BC%80%E5%8F%91%E5%90%84%E7%A7%8D%E7%83%AD%E9%87%8D%E8%BD%BD%E8%BE%B9%E6%94%B9%E8%BE%B9%E7%9C%8B%EF%BC%8C%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C%E4%B8%9D%E8%88%AC%E6%B6%A6%E6%BB%91%EF%BC%8C%E7%82%B9%E5%90%8D%E8%A1%A8%E6%89%AC%20flutter%20%E3%80%82%E6%A1%8C%E9%9D%A2%E7%AB%AF%20winui3%20%E7%A8%8D%E5%BE%AE%E6%94%B9%E7%82%B9%E4%B8%9C%E8%A5%BF%E7%A8%8B%E5%BA%8F%E5%B0%B1%E8%A6%81%E5%AE%8C%E5%85%A8%E9%87%8D%E5%90%AF%EF%BC%8C%E5%90%AF%E5%8A%A8%E9%80%9F%E5%BA%A6%E8%BF%98%E8%B4%BC%E6%85%A2%EF%BC%8C%E8%AF%B4%E6%98%AF%E5%8E%9F%E7%94%9F%E5%BC%80%E5%8F%91%E4%BD%86%E6%98%AF%E5%90%84%E7%A7%8D%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0%E4%B9%9F%E4%B8%8D%E8%88%92%E6%9C%8D%EF%BC%8C%E6%80%BB%E4%B9%8B%E5%B0%B1%E6%98%AF%E7%BB%99%E4%BA%BA%E4%B8%80%E7%A7%8D%E7%A1%AC%E9%82%A6%E9%82%A6%E7%9A%84%E6%84%9F%E8%A7%89%E3%80%82%E5%B0%B1%E8%BF%99%E7%A7%8D%E4%BD%93%E9%AA%8C%EF%BC%8C%E8%83%BD%E6%AF%94%E4%BA%BA%E5%AE%B6%E5%A5%BD%E6%89%8D%E6%80%AA%E4%BA%86%E3%80%82) 关于 winui3 本地化功能的一些看法，欢迎讨论 - V2EX

<https://cn.v2ex.com/t/1116798>

[\[9\]](https://learn.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-known-issues#:~:text=This%20can%20happen%20when%20trying,PRI%29%20files) Known Issues with packaged desktop apps - MSIX | Microsoft Learn

<https://learn.microsoft.com/en-us/windows/msix/desktop/desktop-to-uwp-known-issues>

[\[10\]](https://stackoverflow.com/questions/72066002/winui3-build-started-failing-randomly-giving-a-odd-error-about-resources-pri#:~:text=Judging%20from%20the%20error%2C%20the,correctly%20when%20it%20was%20run) c# - WinUI3 build started failing randomly giving a odd error about resources.pri - Stack Overflow

<https://stackoverflow.com/questions/72066002/winui3-build-started-failing-randomly-giving-a-odd-error-about-resources-pri>

[\[11\]](https://github.com/Scighost/WinUI3Keng#:~:text=,5%5D%E3%80%82) GitHub - Scighost/WinUI3Keng: WinUI 3 踩坑记

<https://github.com/Scighost/WinUI3Keng>

[\[13\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Actually%2C%20the%20title%20of%20the,repo) [\[14\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=However%2C%20recently%2C%20many%20developers%20have,the%20community%20to%20use%20it) [\[16\]](https://eu.36kr.com/en/p/3411202919747200#:~:text=Every%20few%20years%2C%20Microsoft%20launches,is%20just%20one%20factor) Microsoft Officially Announces "Truly Open - Sourced" WinUI with 6,800 Stars After 17 - Month "Death" Declaration by Developers: Netizens Question Survival Strategy via External Support

<https://eu.36kr.com/en/p/3411202919747200>

[\[15\]](https://stackoverflow.com/questions/77764786/remove-runfulltrust-capability-from-flutter-windows-application#:~:text=I%27ve%20just%20published%20my%20flutter,following%20explanation%20to%20the%20reviewer) remove runFullTrust capability from flutter Windows application - Stack Overflow

<https://stackoverflow.com/questions/77764786/remove-runfulltrust-capability-from-flutter-windows-application>